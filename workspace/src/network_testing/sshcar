#!/bin/bash
if [ $# -eq 2 ]; then
    
    ssh -t ${2}.local "export ROS_MASTER_URI=http://${1}.local:11311; export ROS_IP=${2}.local; export ROS_HOSTNAME=${2}.local; bash"

elif [ $# -eq 1 ]; then

case "$1" in
    "-h" )
    echo "
    Main syntax: sshcar [MASTERCAR] [SLAVECAR]

        Write out the full hostname for MASTERCAR and SLAVECAR. sshcar is only useful when running from the Master Car.

        Do not close the terminals after sshcar, or else the environment variables will be reset to the default.

    Other syntax:

    sshcar [SLAVECAR]

        Shorthand of the main syntax. Assumes that the master car is the current host, and that the host name of the master is resolvable. 
        
    source sshcar -s
        
        This is used to set the ROS environment variables for the current machine. It performs the same task but without the ssh.

        It is necessary to use source in this case. Without source, the script will run in a child process and will not change any enivornment variables in the current terminal.
    
    sshcar -h        
        
        Pulls up this message for reference.
    "
    ;;
    "-s" )
    
    export ROS_MASTER_URI=http://$(hostname).local:11311
    export ROS_IP=$(hostname).local
    export ROS_HOSTNAME=$(hostname).local

    ;;
    
    * )

    ssh -t ${1}.local "export ROS_MASTER_URI=http://$(hostname).local:11311; export ROS_IP=${1}.local; export ROS_HOSTNAME=${1}.local; bash"
    ;;
esac

else
    echo "Invalid syntax. Type 'sshcar -h' for help."
    
fi


